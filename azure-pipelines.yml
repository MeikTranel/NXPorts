trigger:
  - master

pool:
  vmImage: 'windows-2019'

steps:
- template: build/azdo-corebuild.yml
  parameters:
    buildType: 'prerelease'

- task: DotNetCoreCLI@2
  inputs:
    command: push
    feedPublish: 'NXPorts/Canary'
    searchPatternPush: '$(Build.ArtifactStagingDirectory)/*.nupkg'

- task: DotNetCoreCLI@2
  inputs:
    command: 'test'
    projects: 'tests/**/*.csproj'
    arguments: '--collect:"Code Coverage"'